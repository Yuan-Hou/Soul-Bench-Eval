Command: python evaluate.py --model_input_dir ./input_data/benchmark_v4 --model_output_dir input_data/results/sonic --results_dir ./sonic_arcface --evaluate_subjects arcface_consistency --device cuda:4 --batch_size 16 --sampling 0 --model_args {} --group_id 2 --group_total 30 --filter human
GPU: 4
============================================================

[0;93m2025-11-09 03:37:32.257649530 [W:onnxruntime:Default, device_discovery.cc:164 DiscoverDevicesForPlatform] GPU device discovery failed: device_discovery.cc:89 ReadFileContents Failed to open file: "/sys/class/drm/card26/device/vendor"[m
/home/tione/notebook/private/Human-MME/video_venv/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_inference_collection.py:123: UserWarning: Specified provider 'CUDAExecutionProvider' is not in available provider names.Available providers: 'AzureExecutionProvider, CPUExecutionProvider'
  warnings.warn(
Using hash-based file partitioning: group 2 of 30
Running evaluation for subject: arcface_consistency
Applied providers: ['CPUExecutionProvider'], with options: {'CPUExecutionProvider': {}}
find model: /root/.insightface/models/buffalo_l/1k3d68.onnx landmark_3d_68 ['None', 3, 192, 192] 0.0 1.0
Applied providers: ['CPUExecutionProvider'], with options: {'CPUExecutionProvider': {}}
find model: /root/.insightface/models/buffalo_l/2d106det.onnx landmark_2d_106 ['None', 3, 192, 192] 0.0 1.0
Applied providers: ['CPUExecutionProvider'], with options: {'CPUExecutionProvider': {}}
find model: /root/.insightface/models/buffalo_l/det_10g.onnx detection [1, 3, '?', '?'] 127.5 128.0
Applied providers: ['CPUExecutionProvider'], with options: {'CPUExecutionProvider': {}}
find model: /root/.insightface/models/buffalo_l/genderage.onnx genderage ['None', 3, 96, 96] 0.0 1.0
Applied providers: ['CPUExecutionProvider'], with options: {'CPUExecutionProvider': {}}
find model: /root/.insightface/models/buffalo_l/w600k_r50.onnx recognition ['None', 3, 112, 112] 127.5 127.5
set det-size: (640, 640)

Evaluating ArcFace Consistency:   0%|          | 0/9 [00:00<?, ?it/s]/home/tione/notebook/private/Human-MME/video_venv/lib/python3.10/site-packages/insightface/utils/transform.py:68: FutureWarning: `rcond` parameter will change to the default of machine precision times ``max(M, N)`` where M and N are the input matrix dimensions.
To use the future default and silence this warning we advise to pass `rcond=None`, to keep using the old, explicitly pass `rcond=-1`.
  P = np.linalg.lstsq(X_homo, Y)[0].T # Affine matrix. 3 x 4

Evaluating ArcFace Consistency:   0%|          | 0/9 [04:15<?, ?it/s]
Traceback (most recent call last):
  File "/home/tione/notebook/private/Human-MME/video_eval/evaluate.py", line 142, in <module>
    main()
  File "/home/tione/notebook/private/Human-MME/video_eval/evaluate.py", line 122, in main
    data_list = subject_module.evaluate(
  File "/home/tione/notebook/private/Human-MME/video_eval/subjects/arcface_consistency.py", line 147, in evaluate
    feats_batch = extract_arcface_features(
  File "/home/tione/notebook/private/Human-MME/video_eval/subjects/arcface_consistency.py", line 91, in extract_arcface_features
    faces = _arcface_app.get(np_img)  # Ê£ÄÊµã+ÂØπÈΩê+ÁâπÂæÅ
  File "/home/tione/notebook/private/Human-MME/video_venv/lib/python3.10/site-packages/insightface/app/face_analysis.py", line 75, in get
    model.get(img, face)
  File "/home/tione/notebook/private/Human-MME/video_venv/lib/python3.10/site-packages/insightface/model_zoo/arcface_onnx.py", line 67, in get
    face.embedding = self.get_feat(aimg).flatten()
  File "/home/tione/notebook/private/Human-MME/video_venv/lib/python3.10/site-packages/insightface/model_zoo/arcface_onnx.py", line 84, in get_feat
    net_out = self.session.run(self.output_names, {self.input_name: blob})[0]
  File "/home/tione/notebook/private/Human-MME/video_venv/lib/python3.10/site-packages/onnxruntime/capi/onnxruntime_inference_collection.py", line 287, in run
    return self._sess.run(output_names, input_feed, run_options)
KeyboardInterrupt
